oc create sa aneeshsa

oc get sa

vi role.yaml

apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: robo-role
  namespace: artifactory
rules:
  - apiGroups: [ "*" ]
    resources: [ "pods/exec","pods","deployments" ]
    verbs: [ "get", "list","edit","create","update","delete"  ]

oc create -f role.yaml
oc get role

vi role-binding.yaml

apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: robo-rolebinding
  namespace: artifactory
subjects:
- kind: ServiceAccount
  name: aneeshsa
  namespace: artifactory
roleRef:
  kind: Role
  name: robo-role
  apiGroup: rbac.authorization.k8s.io


oc create -f rolebinding.yaml
oc get rolebinding 



vi sa-pod.yaml

apiVersion: v1
kind: Pod
metadata:
  name: my-pod
  namespace: artifactory
spec:
  serviceAccountName: aneeshsa
  containers:
  - name: con1
    image: ubuntu:latest
    command: ["/bin/sleep"]
    args: ["3600"]


oc create -f sa-pod.yaml

oc get pod

oc exec --it my-pod -- bash
apt update && apt install wget -y

wget https://mirror.openshift.com/pub/openshift-v4/x86_64/clients/ocp/stable/openshift-client-linux.tar.gz

mv oc kubectl /usr/bin
oc get pod
